<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Summarise concept counts • OmopSketch</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Summarise concept counts">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OmopSketch</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/A-summarise_clinical_tables_records.html">Summarise clinical tables records</a></li>
    <li><a class="dropdown-item" href="../articles/B-summarise_concept_counts.html">Summarise concept counts</a></li>
    <li><a class="dropdown-item" href="../articles/C-summarise_pop_characteristics.html">Summarise population characteristics</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/OHDSI/OmopSketch/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Summarise concept counts</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/OHDSI/OmopSketch/blob/main/vignettes/B-summarise_concept_counts.Rmd" class="external-link"><code>vignettes/B-summarise_concept_counts.Rmd</code></a></small>
      <div class="d-none name"><code>B-summarise_concept_counts.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette, we will explore the <em>OmopSketch</em> functions
designed to provide information about the number of counts of specific
concepts. Specifically, there are two key functions that facilitate
this, <code><a href="../reference/summariseConceptCounts.html">summariseConceptCounts()</a></code> and
<code><a href="../reference/plotConceptCounts.html">plotConceptCounts()</a></code>. The former one creates a summary
statistics results with the number of counts per each concept, and the
latter one creates a histogram plot.</p>
<div class="section level3">
<h3 id="create-a-mock-cdm">Create a mock cdm<a class="anchor" aria-label="anchor" href="#create-a-mock-cdm"></a>
</h3>
<p>Let’s see an example of the previous functions. To start with, we
will load essential packages and create a mock cdm using Eunomia
database.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CDMConnector/" class="external-link">CDMConnector</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r.duckdb.org/" class="external-link">duckdb</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://OHDSI.github.io/OmopSketch/">OmopSketch</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://darwin-eu.github.io/CodelistGenerator/" class="external-link">CodelistGenerator</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Connect to Eunomia database</span></span>
<span><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">duckdb</span><span class="fu">::</span><span class="fu"><a href="https://r.duckdb.org/reference/duckdb.html" class="external-link">duckdb</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu">CDMConnector</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/eunomiaDir.html" class="external-link">eunomia_dir</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Creating CDM database /tmp/RtmpOJHyX5/GiBleed_5.3.zip</span></span>
<span><span class="va">cdm</span> <span class="op">&lt;-</span> <span class="fu">CDMConnector</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu.github.io/CDMConnector/reference/cdm_from_con.html" class="external-link">cdmFromCon</a></span><span class="op">(</span></span>
<span>  con <span class="op">=</span> <span class="va">con</span>, cdmSchema <span class="op">=</span> <span class="st">"main"</span>, writeSchema <span class="op">=</span> <span class="st">"main"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: method with signature 'DBIConnection#Id' chosen for function 'dbExistsTable',</span></span>
<span><span class="co">#&gt;  target signature 'duckdb_connection#Id'.</span></span>
<span><span class="co">#&gt;  "duckdb_connection#ANY" would also be valid</span></span>
<span></span>
<span><span class="va">cdm</span> </span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;"># OMOP CDM reference (duckdb) of Synthea synthetic health database</span> <span style="color: #00BBBB;">──────────</span></span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">omop tables:</span> person, observation_period, visit_occurrence, visit_detail,</span></span>
<span><span class="co">#&gt; condition_occurrence, drug_exposure, procedure_occurrence, device_exposure,</span></span>
<span><span class="co">#&gt; measurement, observation, death, note, note_nlp, specimen, fact_relationship,</span></span>
<span><span class="co">#&gt; location, care_site, provider, payer_plan_period, cost, drug_era, dose_era,</span></span>
<span><span class="co">#&gt; condition_era, metadata, cdm_source, concept, vocabulary, domain,</span></span>
<span><span class="co">#&gt; concept_class, concept_relationship, relationship, concept_synonym,</span></span>
<span><span class="co">#&gt; concept_ancestor, source_to_concept_map, drug_strength</span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">cohort tables:</span> -</span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">achilles tables:</span> -</span></span>
<span><span class="co">#&gt; • <span style="font-weight: bold;">other tables:</span> -</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="summarise-concept-counts">Summarise concept counts<a class="anchor" aria-label="anchor" href="#summarise-concept-counts"></a>
</h2>
<p>First, let’s generate a list of codes for the concept
<code>dementia</code> using <a href="https://darwin-eu.github.io/CodelistGenerator/index.html" class="external-link">CodelistGenerator</a>
package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">acetaminophen</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CodelistGenerator/reference/getCandidateCodes.html" class="external-link">getCandidateCodes</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  keywords <span class="op">=</span> <span class="st">"acetaminophen"</span>,</span>
<span>  domains <span class="op">=</span> <span class="st">"Drug"</span>,</span>
<span>  includeDescendants <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="st">"concept_id"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Limiting to domains of interest</span></span>
<span><span class="co">#&gt; Getting concepts to include</span></span>
<span><span class="co">#&gt; Adding descendants</span></span>
<span><span class="co">#&gt; Search completed. Finishing up.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> 7 candidate concepts identified</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Time taken: 0 minutes and 0 seconds</span></span>
<span></span>
<span><span class="va">sinusitis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://darwin-eu.github.io/CodelistGenerator/reference/getCandidateCodes.html" class="external-link">getCandidateCodes</a></span><span class="op">(</span></span>
<span>  cdm <span class="op">=</span> <span class="va">cdm</span>,</span>
<span>  keywords <span class="op">=</span> <span class="st">"sinusitis"</span>,</span>
<span>  domains <span class="op">=</span> <span class="st">"Condition"</span>,</span>
<span>  includeDescendants <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="st">"concept_id"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Limiting to domains of interest</span></span>
<span><span class="co">#&gt; Getting concepts to include</span></span>
<span><span class="co">#&gt; Adding descendants</span></span>
<span><span class="co">#&gt; Search completed. Finishing up.</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> 4 candidate concepts identified</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Time taken: 0 minutes and 0 seconds</span></span></code></pre></div>
<p>Now we want to explore the occurrence of these concepts within the
database. For that, we can use <code><a href="../reference/summariseConceptCounts.html">summariseConceptCounts()</a></code>
from OmopSketch:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summariseConceptCounts.html">summariseConceptCounts</a></span><span class="op">(</span><span class="va">cdm</span>,</span>
<span>                       conceptId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"acetaminophen"</span> <span class="op">=</span> <span class="va">acetaminophen</span>,                          </span>
<span>                                        <span class="st">"sinusitis"</span> <span class="op">=</span> <span class="va">sinusitis</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span>   </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">group_level</span>, <span class="va">variable_name</span>, <span class="va">variable_level</span>, <span class="va">estimate_name</span>, <span class="va">estimate_value</span><span class="op">)</span> <span class="op">|&gt;</span>   </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting concept counts of acetaminophen</span></span>
<span><span class="co">#&gt; Getting use of codes <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50% | ETA:  3s</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting concept counts of sinusitis</span></span>
<span><span class="co">#&gt; Getting use of codes <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50% | ETA:  3sGetting use of codes <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100% | ETA:  0s</span></span>
<span><span class="co">#&gt; Rows: 2,160</span></span>
<span><span class="co">#&gt; Columns: 5</span></span>
<span><span class="co">#&gt; $ group_level    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "acetaminophen", "acetaminophen", "acetaminophen", "ace…</span></span>
<span><span class="co">#&gt; $ variable_name  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Number records", "Number subjects", "Number records", …</span></span>
<span><span class="co">#&gt; $ variable_level <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "overall", "1909-01-01 to 1909-12-31", "1909…</span></span>
<span><span class="co">#&gt; $ estimate_name  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "count", "count", "count", "count", "count", "count", "…</span></span>
<span><span class="co">#&gt; $ estimate_value <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "14205", "2679", "1", "1", "1", "1", "1", "1", "4", "4"…</span></span></code></pre></div>
<p>By default, the function will provide information about either the
number of records (<code>estimate_name == "record_count"</code>) for
each concept_id or the number of people
(<code>estimate_name == "person_count"</code>):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summariseConceptCounts.html">summariseConceptCounts</a></span><span class="op">(</span><span class="va">cdm</span>, </span>
<span>                       conceptId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"acetaminophen"</span> <span class="op">=</span> <span class="va">acetaminophen</span>, </span>
<span>                                        <span class="st">"sinusitis"</span> <span class="op">=</span> <span class="va">sinusitis</span><span class="op">)</span>, </span>
<span>                       countBy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"record"</span>,<span class="st">"person"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">group_level</span>, <span class="va">variable_name</span>, <span class="va">estimate_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">group_level</span>, <span class="va">variable_name</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting concept counts of acetaminophen</span></span>
<span><span class="co">#&gt; Getting use of codes <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50% | ETA:  2s</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting concept counts of sinusitis</span></span>
<span><span class="co">#&gt; Getting use of codes <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50% | ETA:  2sGetting use of codes <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100% | ETA:  0s</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 3</span></span></span>
<span><span class="co">#&gt;   group_level   variable_name   estimate_name</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> acetaminophen Number records  count        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> acetaminophen Number subjects count        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> sinusitis     Number records  count        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> sinusitis     Number subjects count</span></span></code></pre></div>
<p>However, we can specify which one is of interest using
<code>countBy</code> argument:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summariseConceptCounts.html">summariseConceptCounts</a></span><span class="op">(</span><span class="va">cdm</span>, </span>
<span>                       conceptId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"acetaminophen"</span> <span class="op">=</span> <span class="va">acetaminophen</span>,</span>
<span>                                        <span class="st">"sinusitis"</span> <span class="op">=</span> <span class="va">sinusitis</span><span class="op">)</span>,</span>
<span>                       countBy <span class="op">=</span> <span class="st">"record"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">group_level</span>, <span class="va">variable_name</span>, <span class="va">estimate_name</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">group_level</span>, <span class="va">variable_name</span><span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting concept counts of acetaminophen</span></span>
<span><span class="co">#&gt; Getting use of codes <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50% | ETA:  2s</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting concept counts of sinusitis</span></span>
<span><span class="co">#&gt; Getting use of codes <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50% | ETA:  2sGetting use of codes <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100% | ETA:  0s</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 3</span></span></span>
<span><span class="co">#&gt;   group_level   variable_name  estimate_name</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> acetaminophen Number records count        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> sinusitis     Number records count</span></span></code></pre></div>
<p>One can further stratify by year, sex or age group using the
<code>year</code>, <code>sex</code>, and <code>ageGroup</code>
arguments.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summariseConceptCounts.html">summariseConceptCounts</a></span><span class="op">(</span><span class="va">cdm</span>,</span>
<span>                       conceptId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"acetaminophen"</span> <span class="op">=</span> <span class="va">acetaminophen</span>,</span>
<span>                                        <span class="st">"sinusitis"</span> <span class="op">=</span> <span class="va">sinusitis</span><span class="op">)</span>,</span>
<span>                       countBy <span class="op">=</span> <span class="st">"person"</span>,</span>
<span>                       interval <span class="op">=</span> <span class="st">"year"</span>, unitInterval <span class="op">=</span> <span class="fl">10</span>,</span>
<span>                       sex  <span class="op">=</span> <span class="cn">TRUE</span>,  </span>
<span>                       ageGroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"&lt;=50"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span><span class="op">)</span>, <span class="st">"&gt;50"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">51</span>,<span class="cn">Inf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span>   </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">group_level</span>, <span class="va">strata_level</span>, <span class="va">variable_name</span>, <span class="va">estimate_name</span><span class="op">)</span> <span class="op">|&gt;</span>   <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting concept counts of acetaminophen</span></span>
<span><span class="co">#&gt; Getting use of codes <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50% | ETA:  3s</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting concept counts of sinusitis</span></span>
<span><span class="co">#&gt; Getting use of codes <span style="color: #00BB00;">■■■■■■■■■■■■■■■■                </span>  50% | ETA:  3sGetting use of codes <span style="color: #00BB00;">■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■ </span> 100% | ETA:  0s</span></span>
<span><span class="co">#&gt; Rows: 1,067</span></span>
<span><span class="co">#&gt; Columns: 4</span></span>
<span><span class="co">#&gt; $ group_level   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "acetaminophen", "acetaminophen", "acetaminophen", "acet…</span></span>
<span><span class="co">#&gt; $ strata_level  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "overall", "&lt;=50", "&gt;50", "Female", "Male", "overall", "…</span></span>
<span><span class="co">#&gt; $ variable_name <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Number subjects", "Number subjects", "Number subjects",…</span></span>
<span><span class="co">#&gt; $ estimate_name <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "count", "count", "count", "count", "count", "count", "c…</span></span></code></pre></div>
<div class="section level3">
<h3 id="visualise-the-results">Visualise the results<a class="anchor" aria-label="anchor" href="#visualise-the-results"></a>
</h3>
<p>Finally, we can visualise the concept counts using
<code>plotRecordCounts()</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summariseConceptCounts.html">summariseConceptCounts</a></span><span class="op">(</span><span class="va">cdm</span>, </span>
<span>                       conceptId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sinusitis"</span> <span class="op">=</span> <span class="va">sinusitis</span><span class="op">)</span>, </span>
<span>                       countBy <span class="op">=</span> <span class="st">"person"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/plotConceptCounts.html">plotConceptCounts</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting concept counts of sinusitis</span></span></code></pre></div>
<p><img src="B-summarise_concept_counts_files/figure-html/unnamed-chunk-8-1.png" width="700">
Notice that either person counts or record counts can be plotted. If
both have been included in the summarised result, you will have to
filter to only include one variable at time:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summariseConceptCounts.html">summariseConceptCounts</a></span><span class="op">(</span><span class="va">cdm</span>, </span>
<span>                       conceptId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sinusitis"</span> <span class="op">=</span> <span class="va">sinusitis</span><span class="op">)</span>,</span>
<span>                       countBy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"person"</span>,<span class="st">"record"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">variable_name</span> <span class="op">==</span> <span class="st">"Number subjects"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/plotConceptCounts.html">plotConceptCounts</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting concept counts of sinusitis</span></span></code></pre></div>
<p><img src="B-summarise_concept_counts_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>Additionally, if results were stratified by year, sex or age group,
we can further use <code>facet</code> or <code>colour</code> arguments
to highlight the different results in the plot. To help us identify by
which variables we can colour or facet by, we can use <a href="https://darwin-eu.github.io/visOmopResults/" class="external-link">visOmopResult</a>
package.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/summariseConceptCounts.html">summariseConceptCounts</a></span><span class="op">(</span><span class="va">cdm</span>, </span>
<span>                       conceptId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sinusitis"</span> <span class="op">=</span> <span class="va">sinusitis</span><span class="op">)</span>,</span>
<span>                       countBy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"person"</span><span class="op">)</span>,</span>
<span>                       sex <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                       ageGroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"&lt;=50"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span><span class="op">)</span>, <span class="st">"&gt;50"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">51</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">visOmopResults</span><span class="fu">::</span><span class="fu"><a href="https://darwin-eu.github.io/visOmopResults/reference/tidyColumns.html" class="external-link">tidyColumns</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting concept counts of sinusitis</span></span>
<span><span class="co">#&gt;  [1] "cdm_name"              "codelist_name"         "age_group"            </span></span>
<span><span class="co">#&gt;  [4] "sex"                   "variable_name"         "variable_level"       </span></span>
<span><span class="co">#&gt;  [7] "count"                 "standard_concept_name" "standard_concept_id"  </span></span>
<span><span class="co">#&gt; [10] "source_concept_name"   "source_concept_id"     "domain_id"            </span></span>
<span><span class="co">#&gt; [13] "result_type"           "package_name"          "package_version"      </span></span>
<span><span class="co">#&gt; [16] "interval"              "unitInterval"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/summariseConceptCounts.html">summariseConceptCounts</a></span><span class="op">(</span><span class="va">cdm</span>, </span>
<span>                       conceptId <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"sinusitis"</span> <span class="op">=</span> <span class="va">sinusitis</span><span class="op">)</span>,</span>
<span>                       countBy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"person"</span><span class="op">)</span>,</span>
<span>                       sex <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                       ageGroup <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"&lt;=50"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">50</span><span class="op">)</span>, <span class="st">"&gt;50"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">51</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/plotConceptCounts.html">plotConceptCounts</a></span><span class="op">(</span>facet <span class="op">=</span> <span class="st">"sex"</span>, colour <span class="op">=</span> <span class="st">"age_group"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Getting concept counts of sinusitis</span></span></code></pre></div>
<p><img src="B-summarise_concept_counts_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Marta Alcalde-Herraiz, Kim Lopez-Guell, Elin Rowlands, Edward Burn, Martí Català.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
